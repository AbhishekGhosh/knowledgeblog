#!/usr/bin/env python

import os.path
from subprocess import *


## run this from your wp-content/plugins directory it checks all the external
## kblog plugins out into your local plugins directory ready to use

basesvn="http://svn.wp-plugins.org/"

## config -- plugin name, required version
config = (
    ("co-authors-plus", "2.1.1"),
    ("post-revision-display", "0.9"),
    ("wp-post-to-pdf", "2.0.1"),
    ("edit-flow", "0.6.3"),
    ("epub-export", "1.1"),
    ("syntaxhighlighter", "3.1.1"),
    ("wp-gravatar", "2.6"),
    ("wordpress-table-of-contents", "1.2.0"),
)



for plugin in config:
    if os.path.exists( plugin[ 0 ] ):
        print( "Checking for update: %s" % (plugin[0]) )
        output = Popen( ["svn",
                         "switch", "%s%s/tags/%s" %
                     (basesvn, plugin[0], plugin[1]),
                     plugin[ 0 ]
                     ],stdout=PIPE).communicate()[0]
        print( output )
    else:
        print( "Checking out: %s" % (plugin[0]) )
        output = Popen( ["svn",
                         "checkout", "%s%s/tags/%s" %
                     (basesvn, plugin[0], plugin[1]),
                     plugin[ 0 ]
                     ],
                    stdout=PIPE).communicate()[0]
        print( output )

